title: CVE-2021-3156 Root Password Change
id: D0E2749B-3D4E-415F-97AA-2FEB0F76F4C2
status: test
description: >
  Detects a root-password reset on Linux systems—often
  the final step after exploiting **CVE-2021-3156 (sudo heap-overflow)**
  to gain root.  Triggers on OCSF *System / Syslog* events
  (`class_uid: 5023`) whose syslog line from **passwd** reports
  *“password changed for root”*.

author: bsk2002
date: 2025-07-29
tags:
  - ocsf.system_log
  - sudo.cve_2021_3156
  - attack.privilege_escalation
  - attack.root_password_change

logsource:
  product: ocsf
  category: system
  service: syslog

detection:
  syslog_event:
    class_uid: 5023

  syslog_msg:
    message|contains:
      - passwd
      - password changed for root
  
  condition: syslog_event and syslog_msg


falsepositives:
  - 관리자에 의한 정상 root 비밀번호 변경
  - 보안 정책 준수를 위한 정기 변경

level: high