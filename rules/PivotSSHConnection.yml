title: Pivot SSH Connection
id: 2E71E15B-8D62-4A9E-9B19-3CF30456B995
status: test
description: >
  Detects an **SSH session established to an internal “pivot” server**
  and subsequently closed (log line contains *“Disconnected from user …”*).
  Logged as an OCSF *System Log* event (`class_uid: 4007`) generated by
  **sshd**.  
  A match indicates that a host (10.0.x.x) successfully connected as
  **user ubuntu** to another host (the pivot box) and then terminated
  the session—behaviour often seen during lateral movement.

author: bsk2002
date: 2025-07-29
tags:
  - ocsf.system_log
  - ssh.session
  - attack.lateral_movement
  - event_type.pivot

logsource:
  product: ocsf
  category: system
  service: syslog

detection:
  sel_class:
    class_uid: 4007

  sel_msg1:
    message.keyword|contains: "sshd["

  sel_msg2:
    message.keyword|contains: "Accepted publickey for ubuntu"

  condition: sel_class and sel_msg1 and sel_msg2

falsepositives:
  - 정상 운영자 세션 종료
  - 스크립트·배치 작업의 SSH 종료

level: medium
